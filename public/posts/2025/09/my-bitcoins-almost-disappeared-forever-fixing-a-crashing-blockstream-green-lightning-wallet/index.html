<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Hassen Harzallah "><meta name=description content="I recently faced every Bitcoiner‚Äôs nightmare: I had just bought my first Bitcoin, set up Blockstream Green with a Lightning account, and suddenly the app on my Android phone started crashing immediately at startup. My Lightning funds were locked inside my phone, and unlike with on-chain Bitcoin, writing down my seed phrase wasn‚Äôt enough ‚Äî Lightning state lives on-device.
I contacted Blockstream support right away. Unfortunately, the process was long, and their answers didn‚Äôt solve anything:"><meta name=keywords content=",bitcoin,android,debugging"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://hhassen.github.io/posts/2025/09/my-bitcoins-almost-disappeared-forever-fixing-a-crashing-blockstream-green-lightning-wallet/><title>My Bitcoins almost disappeared forever: Fixing a Crashing Blockstream Green Lightning Wallet :: Hassen Harzallah</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=../../../../main.dede02da9537a98158079c023e83573e18127834838ef08172acce888341a797.css><meta itemprop=name content="My Bitcoins almost disappeared forever: Fixing a Crashing Blockstream Green Lightning Wallet"><meta itemprop=description content="A step-by-step walkthrough of how I rescued my Bitcoin Lightning funds from a crashing Blockstream Green app using backups, ADB logs, and a version downgrade."><meta itemprop=datePublished content="2025-09-11T10:00:00+00:00"><meta itemprop=dateModified content="2025-09-11T10:00:00+00:00"><meta itemprop=wordCount content="635"><meta itemprop=keywords content="bitcoin,android,debugging,"><meta name=twitter:card content="summary"><meta name=twitter:title content="My Bitcoins almost disappeared forever: Fixing a Crashing Blockstream Green Lightning Wallet"><meta name=twitter:description content="A step-by-step walkthrough of how I rescued my Bitcoin Lightning funds from a crashing Blockstream Green app using backups, ADB logs, and a version downgrade."><meta property="article:published_time" content="2025-09-11 10:00:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=../../../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd ~</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://hhassen.github.io/about>About</a></li><li><a href=https://hhassen.github.io/posts>Blog</a></li><li><a href=https://hhassen.github.io/tags>Tags</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>3 minutes</p></div><article><h1 class=post-title><a href=https://hhassen.github.io/posts/2025/09/my-bitcoins-almost-disappeared-forever-fixing-a-crashing-blockstream-green-lightning-wallet/>My Bitcoins almost disappeared forever: Fixing a Crashing Blockstream Green Lightning Wallet</a></h1><div class=post-content><p>I recently faced every Bitcoiner‚Äôs nightmare: I had just bought my first Bitcoin, set up Blockstream Green with a Lightning account, and suddenly the app on my Android phone started crashing immediately at startup. My Lightning funds were locked inside my phone, and unlike with on-chain Bitcoin, writing down my seed phrase wasn‚Äôt enough ‚Äî Lightning state lives on-device.</p><p>I contacted Blockstream support right away. Unfortunately, the process was long, and their answers didn‚Äôt solve anything:</p><ul><li>They suggested updating the app ‚Äî but I was already on the latest version.</li><li>They suggested making a backup ‚Äî but for Lightning, a seed alone won‚Äôt restore your state.</li></ul><p>That‚Äôs when I realized: if I wanted to save my coins, I needed to find a solution myself.</p><hr><h2 id=step-1-back-up-everything-before-testing>Step 1: Back up everything before testing</h2><p>Before experimenting, I made sure to back up the app data. This was critical, because my Lightning channels lived inside my phone.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb backup -apk -obb -shared com.greenaddress.greenbits_android_wallet
</span></span></code></pre></div><p>This backup contained a SQLite database with encrypted_data, pin_data, wallet_id, and network. It confirmed that both on-chain (electrum-mainnet) and Lightning (greenlight-mainnet) information was stored locally.</p><hr><h2 id=step-2-attempting-decryption-and-knowing-when-to-stop>Step 2: Attempting decryption (and knowing when to stop)</h2><p>I explored whether I could decrypt the stored data using my PIN and the app‚Äôs own encryption scheme:</p><p>üîê <strong>Encryption Algorithm Overview</strong></p><ul><li>Key derivation: PBKDF2 with HMAC-SHA512</li><li>Inputs: PIN + salt (base64-decoded) + 100,000 iterations</li><li>Output: 32-byte AES-256 key</li><li>Decryption: AES-256 in CBC mode; IV = first 16 bytes of <code>encrypted_data</code></li></ul><p>I tried writing a Python script to decrypt this, but after a few attempts I decided not to push further. Decrypting wasn‚Äôt the real goal ‚Äî restoring a working app environment was.</p><hr><h2 id=step-3-investigating-crash-logs-with-adb>Step 3: Investigating crash logs with ADB</h2><p>Next, I turned to logs.</p><p>Find the package name:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb shell pm list packages | grep green
</span></span><span style=display:flex><span>com.blockstream.green
</span></span></code></pre></div><p>Find the running process ID:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb shell pidof com.blockstream.green
</span></span><span style=display:flex><span><span style=color:#ae81ff>12345</span>
</span></span></code></pre></div><p>Dump logs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb logcat --pid<span style=color:#f92672>=</span><span style=color:#ae81ff>12345</span> &gt; green_crash_log.txt
</span></span></code></pre></div><p>The logs revealed the issue:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>java.lang.IllegalArgumentException: Invalid notification <span style=color:#f92672>(</span>no valid small icon<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Translation: the app was trying to start a foreground service (likely for Lightning operations) but failed because the required <strong>notification icon</strong> was missing. This was a coding bug ‚Äî not data loss.</p><hr><h2 id=step-4-reinstall-attempts-and-support-dead-ends>Step 4: Reinstall attempts and support dead ends</h2><p>Support had advised me to update, but reinstalling the latest APK didn‚Äôt help. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb install -r blockstream_green.apk
</span></span><span style=display:flex><span>adb.exe: failed to install .<span style=color:#ae81ff>\B</span>lockstreamGreen-v4.1.8-productionGoogle-release.apk: Failure <span style=color:#f92672>[</span>INSTALL_FAILED_USER_RESTRICTED: Install canceled by user<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>After enabling <strong>Allow USB installs</strong>, the reinstall worked:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb.exe install -r .<span style=color:#ae81ff>\B</span>lockstreamGreen-v4.1.8-productionGoogle-release.apk
</span></span><span style=display:flex><span>Success
</span></span></code></pre></div><p>But the crash persisted.</p><p>At this point, I went beyond what support had suggested: try a downgrade.</p><hr><h2 id=step-5-downgrade-as-the-real-fix>Step 5: Downgrade as the real fix</h2><p>Attempting to install v4.1.5 at first failed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb.exe install -r .<span style=color:#ae81ff>\B</span>lockstreamGreen-v4.1.5-productionGoogle-release.apk
</span></span><span style=display:flex><span>adb.exe: failed to install .<span style=color:#ae81ff>\B</span>lockstreamGreen-v4.1.5-productionGoogle-release.apk: Failure <span style=color:#f92672>[</span>INSTALL_FAILED_VERSION_DOWNGRADE<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Solution: add the <code>-d</code> flag to force a downgrade.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb.exe install -r -d .<span style=color:#ae81ff>\B</span>lockstreamGreen-v4.1.5-productionGoogle-release.apk
</span></span><span style=display:flex><span>Performing Streamed Install
</span></span><span style=display:flex><span>Success
</span></span></code></pre></div><p>And just like that: the older version opened successfully, my wallet loaded, and my Lightning funds were safe.</p><hr><h2 id=conclusion-what-i-learned>Conclusion: what I learned</h2><ul><li><p><strong>Lightning is device-dependent.</strong> A seed phrase isn‚Äôt enough. Backups of the app state are critical.</p></li><li><p><strong>Support isn‚Äôt always enough.</strong> The official team couldn‚Äôt resolve this issue ‚Äî updating and backing up weren‚Äôt real fixes.</p></li><li><p><strong>Logs point to answers.</strong> ADB logcat gave me the exact reason for the crash: a missing notification icon.</p></li><li><p><strong>Downgrade = lifesaver.</strong> Reverting to v4.1.5 bypassed the bug and restored full access to my funds.</p></li><li><p><strong>The relief is unforgettable.</strong> After hours of uncertainty, finally seeing my wallet open again was the moment I knew I had saved my Bitcoin from vanishing.</p></li></ul><hr><p>‚ú® This experience taught me to always back up, to follow the data, and not to rely solely on official fixes when dealing with critical funds. Sometimes, the only way forward is persistence, patience, and a willingness to get your hands dirty with the technical details.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://hhassen.github.io/tags/bitcoin>bitcoin</a></span><span class=tag><a href=https://hhassen.github.io/tags/android>android</a></span><span class=tag><a href=https://hhassen.github.io/tags/debugging>debugging</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>635 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2025-09-11 10:00 +0000</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://hhassen.github.io/posts/2021/12/monitoring-to-detect-incidents/><span class=button__text>Monitoring to detect incidents</span>
<span class=button__icon>‚Üí</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2025</span>
<span><a href=https://hhassen.github.io/>Hassen Harzallah</a></span>
<span><a href=https://hhassen.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=../../../../bundle.min.8cc3758efe48ef82e2eb9a5f317b44c0805353a43762207be6fe8ffb05815cce7a19d37f6bf387c378a3bdfc3029981668d645374a33db4ee3480e15a4bfdc7c.js integrity="sha512-jMN1jv5I74Li65pfMXtEwIBTU6Q3YiB75v6P+wWBXM56GdN/a/OHw3ijvfwwKZgWaNZFN0oz207jSA4VpL/cfA=="></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-143758672-1","auto"),ga("send","pageview"))</script></body></html>